import { c as create_ssr_component } from "../../../chunks/ssr.js";
import "chart.js/auto";
import "../../../chunks/supabase.js";
const css = {
  code: "td.income.svelte-7ozrif{color:var(--color-income)}td.expense.svelte-7ozrif{color:var(--color-expense)}",
  map: '{"version":3,"file":"+page.svelte","sources":["+page.svelte"],"sourcesContent":["<script lang=\\"ts\\">import { onMount, tick } from \\"svelte\\";\\nimport Chart from \\"chart.js/auto\\";\\nimport { getMonthlySummary, getCategoryBreakdown } from \\"$lib/api\\";\\nlet loading = true;\\nlet error = \\"\\";\\nlet selectedYear = (/* @__PURE__ */ new Date()).getFullYear();\\nlet monthlyData = [];\\nlet categoryData = [];\\nlet barChartCanvas;\\nlet categoryChartCanvas;\\nlet barChart = null;\\nlet categoryChart = null;\\nconst years = Array.from({ length: 5 }, (_, i) => (/* @__PURE__ */ new Date()).getFullYear() - i);\\nonMount(async () => {\\n  await loadData();\\n});\\nasync function loadData() {\\n  loading = true;\\n  error = \\"\\";\\n  try {\\n    monthlyData = [];\\n    for (let m = 1; m <= 12; m++) {\\n      if (selectedYear === (/* @__PURE__ */ new Date()).getFullYear() && m > (/* @__PURE__ */ new Date()).getMonth() + 1) {\\n        break;\\n      }\\n      const summary = await getMonthlySummary(selectedYear, m);\\n      monthlyData.push({\\n        month: new Date(selectedYear, m - 1).toLocaleDateString(\\"en-US\\", { month: \\"short\\" }),\\n        income: summary.total_income,\\n        expense: summary.total_expense,\\n        net: summary.total_income - summary.total_expense\\n      });\\n    }\\n    categoryData = await getCategoryBreakdown(\\"expense\\", selectedYear);\\n    await tick();\\n    await renderCharts();\\n  } catch (e) {\\n    error = e.message;\\n  } finally {\\n    loading = false;\\n  }\\n}\\nasync function renderCharts() {\\n  if (!barChartCanvas || !categoryChartCanvas) {\\n    setTimeout(renderCharts, 100);\\n    return;\\n  }\\n  if (barChart) {\\n    barChart.destroy();\\n    barChart = null;\\n  }\\n  if (categoryChart) {\\n    categoryChart.destroy();\\n    categoryChart = null;\\n  }\\n  const barCtx = barChartCanvas.getContext(\\"2d\\");\\n  if (barCtx) {\\n    const incomeGradient = barCtx.createLinearGradient(0, 0, 0, 300);\\n    incomeGradient.addColorStop(0, \\"#10b981\\");\\n    incomeGradient.addColorStop(1, \\"#059669\\");\\n    const expenseGradient = barCtx.createLinearGradient(0, 0, 0, 300);\\n    expenseGradient.addColorStop(0, \\"#f43f5e\\");\\n    expenseGradient.addColorStop(1, \\"#e11d48\\");\\n    barChart = new Chart(barCtx, {\\n      type: \\"bar\\",\\n      data: {\\n        labels: monthlyData.map((d) => d.month),\\n        datasets: [\\n          {\\n            label: \\"Income\\",\\n            data: monthlyData.map((d) => d.income),\\n            backgroundColor: incomeGradient,\\n            borderRadius: 6,\\n            borderSkipped: false\\n          },\\n          {\\n            label: \\"Expenses\\",\\n            data: monthlyData.map((d) => d.expense),\\n            backgroundColor: expenseGradient,\\n            borderRadius: 6,\\n            borderSkipped: false\\n          }\\n        ]\\n      },\\n      options: {\\n        responsive: true,\\n        maintainAspectRatio: false,\\n        plugins: {\\n          legend: {\\n            position: \\"top\\",\\n            align: \\"end\\",\\n            labels: {\\n              color: \\"#94a3b8\\",\\n              font: { size: 12, family: \\"Inter\\" },\\n              usePointStyle: true,\\n              pointStyle: \\"circle\\",\\n              padding: 20\\n            }\\n          },\\n          tooltip: {\\n            backgroundColor: \\"#1e293b\\",\\n            titleColor: \\"#f8fafc\\",\\n            bodyColor: \\"#94a3b8\\",\\n            borderColor: \\"#334155\\",\\n            borderWidth: 1,\\n            padding: 12,\\n            callbacks: {\\n              label: (context) => ` ${context.dataset.label}: $${context.parsed.y.toLocaleString()}`\\n            }\\n          }\\n        },\\n        scales: {\\n          x: {\\n            ticks: {\\n              color: \\"#64748b\\",\\n              font: { size: 12, family: \\"Inter\\" }\\n            },\\n            grid: { display: false }\\n          },\\n          y: {\\n            ticks: {\\n              color: \\"#64748b\\",\\n              font: { size: 11, family: \\"Inter\\" },\\n              callback: (value) => `$${(value / 1e3).toFixed(0)}k`\\n            },\\n            grid: {\\n              color: \\"#1f2937\\",\\n              drawBorder: false\\n            }\\n          }\\n        }\\n      }\\n    });\\n  }\\n  const catCtx = categoryChartCanvas.getContext(\\"2d\\");\\n  if (catCtx && categoryData.length > 0) {\\n    const catGradient = catCtx.createLinearGradient(0, 0, 300, 0);\\n    catGradient.addColorStop(0, \\"#3b82f6\\");\\n    catGradient.addColorStop(1, \\"#60a5fa\\");\\n    categoryChart = new Chart(catCtx, {\\n      type: \\"bar\\",\\n      data: {\\n        labels: categoryData.slice(0, 10).map((d) => `${d.icon} ${d.name}`),\\n        datasets: [{\\n          label: \\"Spending\\",\\n          data: categoryData.slice(0, 10).map((d) => d.total),\\n          backgroundColor: catGradient,\\n          borderRadius: 4,\\n          borderSkipped: false\\n        }]\\n      },\\n      options: {\\n        indexAxis: \\"y\\",\\n        responsive: true,\\n        maintainAspectRatio: false,\\n        plugins: {\\n          legend: { display: false },\\n          tooltip: {\\n            backgroundColor: \\"#1e293b\\",\\n            titleColor: \\"#f8fafc\\",\\n            bodyColor: \\"#94a3b8\\",\\n            borderColor: \\"#334155\\",\\n            borderWidth: 1,\\n            padding: 12,\\n            callbacks: {\\n              label: (context) => ` $${context.parsed.x.toLocaleString()}`\\n            }\\n          }\\n        },\\n        scales: {\\n          x: {\\n            ticks: {\\n              color: \\"#64748b\\",\\n              font: { size: 11, family: \\"Inter\\" },\\n              callback: (value) => `$${(value / 1e3).toFixed(0)}k`\\n            },\\n            grid: {\\n              color: \\"#1f2937\\",\\n              drawBorder: false\\n            }\\n          },\\n          y: {\\n            ticks: {\\n              color: \\"#f8fafc\\",\\n              font: { size: 12, family: \\"Inter\\" }\\n            },\\n            grid: { display: false }\\n          }\\n        }\\n      }\\n    });\\n  }\\n}\\n$: totalIncome = monthlyData.reduce((sum, d) => sum + d.income, 0);\\n$: totalExpense = monthlyData.reduce((sum, d) => sum + d.expense, 0);\\n$: totalNet = totalIncome - totalExpense;\\nfunction formatCurrency(amount) {\\n  return amount.toLocaleString(\\"en-US\\", {\\n    style: \\"currency\\",\\n    currency: \\"USD\\",\\n    maximumFractionDigits: 0\\n  });\\n}\\n<\/script>\\n\\n<svelte:head>\\n  <title>Reports - Jim\'s Finance</title>\\n</svelte:head>\\n\\n<div class=\\"page\\">\\n  <header class=\\"page-header\\">\\n    <h1 class=\\"page-title\\">Reports</h1>\\n    <p class=\\"page-subtitle\\">Annual financial overview</p>\\n  </header>\\n  \\n  {#if loading}\\n    <div class=\\"loading\\">Loading reports...</div>\\n  {:else if error}\\n    <div class=\\"error\\">{error}</div>\\n  {:else}\\n    <!-- Year Selector -->\\n    <div class=\\"card animate-fade-in\\">\\n      <div class=\\"form-group\\" style=\\"margin-bottom: 0;\\">\\n        <label>Select Year</label>\\n        <select class=\\"input\\" bind:value={selectedYear} on:change={loadData}>\\n          {#each years as year}\\n            <option value={year}>{year}</option>\\n          {/each}\\n        </select>\\n      </div>\\n    </div>\\n    \\n    <!-- Annual Summary -->\\n    <div class=\\"metric-grid animate-fade-in stagger-1\\">\\n      <div class=\\"metric-card\\">\\n        <div class=\\"metric-label\\">Total Income</div>\\n        <div class=\\"metric-value income\\">{formatCurrency(totalIncome)}</div>\\n      </div>\\n      \\n      <div class=\\"metric-card\\">\\n        <div class=\\"metric-label\\">Total Expenses</div>\\n        <div class=\\"metric-value expense\\">{formatCurrency(totalExpense)}</div>\\n      </div>\\n      \\n      <div class=\\"metric-card\\">\\n        <div class=\\"metric-label\\">Annual Net</div>\\n        <div class=\\"metric-value\\" class:income={totalNet >= 0} class:expense={totalNet < 0}>\\n          {formatCurrency(totalNet)}\\n        </div>\\n      </div>\\n    </div>\\n    \\n    <!-- Monthly Trend Chart -->\\n    <div class=\\"card chart-container animate-fade-in stagger-2\\">\\n      <div class=\\"card-header\\">\\n        <h3 class=\\"card-title\\">ðŸ“ˆ Monthly Trend</h3>\\n      </div>\\n      <div class=\\"chart-wrapper chart-wrapper-lg\\">\\n        <canvas bind:this={barChartCanvas}></canvas>\\n      </div>\\n    </div>\\n    \\n    <!-- Category Breakdown Chart -->\\n    <div class=\\"card chart-container animate-fade-in stagger-3\\">\\n      <div class=\\"card-header\\">\\n        <h3 class=\\"card-title\\">ðŸ’³ Top Spending Categories</h3>\\n      </div>\\n      {#if categoryData.length > 0}\\n        <div class=\\"chart-wrapper\\">\\n          <canvas bind:this={categoryChartCanvas}></canvas>\\n        </div>\\n      {:else}\\n        <div class=\\"empty-state\\">\\n          <div class=\\"empty-state-icon\\">ðŸ“Š</div>\\n          <p>No expense data for this year</p>\\n        </div>\\n      {/if}\\n    </div>\\n    \\n    <!-- Monthly Breakdown Table -->\\n    <div class=\\"card animate-fade-in stagger-4\\">\\n      <div class=\\"card-header\\">\\n        <h3 class=\\"card-title\\">ðŸ“‹ Monthly Summary</h3>\\n      </div>\\n      \\n      <div class=\\"table-container\\">\\n        <table>\\n          <thead>\\n            <tr>\\n              <th>Month</th>\\n              <th>Income</th>\\n              <th>Expenses</th>\\n              <th>Net</th>\\n            </tr>\\n          </thead>\\n          <tbody>\\n            {#each monthlyData as row}\\n              <tr>\\n                <td>{row.month}</td>\\n                <td class=\\"income\\">{formatCurrency(row.income)}</td>\\n                <td class=\\"expense\\">{formatCurrency(row.expense)}</td>\\n                <td class:income={row.net >= 0} class:expense={row.net < 0}>\\n                  {formatCurrency(row.net)}\\n                </td>\\n              </tr>\\n            {/each}\\n          </tbody>\\n        </table>\\n      </div>\\n    </div>\\n  {/if}\\n</div>\\n\\n<style>\\n  td.income {\\n    color: var(--color-income);\\n  }\\n  \\n  td.expense {\\n    color: var(--color-expense);\\n  }\\n</style>\\n"],"names":[],"mappings":"AA0TE,EAAE,qBAAQ,CACR,KAAK,CAAE,IAAI,cAAc,CAC3B,CAEA,EAAE,sBAAS,CACT,KAAK,CAAE,IAAI,eAAe,CAC5B"}'
};
const Page = create_ssr_component(($$result, $$props, $$bindings, slots) => {
  let monthlyData = [];
  Array.from({ length: 5 }, (_, i) => /* @__PURE__ */ (/* @__PURE__ */ new Date()).getFullYear() - i);
  $$result.css.add(css);
  monthlyData.reduce((sum, d) => sum + d.income, 0);
  monthlyData.reduce((sum, d) => sum + d.expense, 0);
  return `${$$result.head += `<!-- HEAD_svelte-yqptod_START -->${$$result.title = `<title>Reports - Jim&#39;s Finance</title>`, ""}<!-- HEAD_svelte-yqptod_END -->`, ""} <div class="page"><header class="page-header" data-svelte-h="svelte-eshxsc"><h1 class="page-title">Reports</h1> <p class="page-subtitle">Annual financial overview</p></header> ${`<div class="loading" data-svelte-h="svelte-1vdf2ms">Loading reports...</div>`} </div>`;
});
export {
  Page as default
};
