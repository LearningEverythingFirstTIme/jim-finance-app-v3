import { c as create_ssr_component } from "../../../chunks/ssr.js";
import "chart.js/auto";
import "../../../chunks/supabase.js";
const css = {
  code: ".chart-container.svelte-n59edb h3.svelte-n59edb{margin-top:0;margin-bottom:1rem}td.income.svelte-n59edb.svelte-n59edb{color:#22c55e}td.expense.svelte-n59edb.svelte-n59edb{color:#ef4444}",
  map: '{"version":3,"file":"+page.svelte","sources":["+page.svelte"],"sourcesContent":["<script lang=\\"ts\\">import { onMount } from \\"svelte\\";\\nimport Chart from \\"chart.js/auto\\";\\nimport { getMonthlySummary, getCategoryBreakdown } from \\"$lib/api\\";\\nlet loading = true;\\nlet error = \\"\\";\\nlet selectedYear = (/* @__PURE__ */ new Date()).getFullYear();\\nlet monthlyData = [];\\nlet categoryData = [];\\nlet barChartCanvas;\\nlet categoryChartCanvas;\\nlet barChart;\\nlet categoryChart;\\nconst years = Array.from({ length: 5 }, (_, i) => (/* @__PURE__ */ new Date()).getFullYear() - i);\\nonMount(async () => {\\n  await loadData();\\n});\\nasync function loadData() {\\n  loading = true;\\n  error = \\"\\";\\n  try {\\n    monthlyData = [];\\n    for (let m = 1; m <= 12; m++) {\\n      if (selectedYear === (/* @__PURE__ */ new Date()).getFullYear() && m > (/* @__PURE__ */ new Date()).getMonth() + 1) {\\n        break;\\n      }\\n      const summary = await getMonthlySummary(selectedYear, m);\\n      monthlyData.push({\\n        month: new Date(selectedYear, m - 1).toLocaleDateString(\\"en-US\\", { month: \\"short\\" }),\\n        income: summary.total_income,\\n        expense: summary.total_expense,\\n        net: summary.total_income - summary.total_expense\\n      });\\n    }\\n    categoryData = await getCategoryBreakdown(\\"expense\\", selectedYear);\\n    renderCharts();\\n  } catch (e) {\\n    error = e.message;\\n  } finally {\\n    loading = false;\\n  }\\n}\\nfunction renderCharts() {\\n  if (barChart) barChart.destroy();\\n  barChart = new Chart(barChartCanvas, {\\n    type: \\"bar\\",\\n    data: {\\n      labels: monthlyData.map((d) => d.month),\\n      datasets: [\\n        {\\n          label: \\"Income\\",\\n          data: monthlyData.map((d) => d.income),\\n          backgroundColor: \\"#22c55e\\"\\n        },\\n        {\\n          label: \\"Expenses\\",\\n          data: monthlyData.map((d) => d.expense),\\n          backgroundColor: \\"#ef4444\\"\\n        }\\n      ]\\n    },\\n    options: {\\n      responsive: true,\\n      maintainAspectRatio: false,\\n      plugins: {\\n        legend: {\\n          labels: { color: \\"#f8fafc\\" }\\n        }\\n      },\\n      scales: {\\n        x: {\\n          ticks: { color: \\"#94a3b8\\" },\\n          grid: { color: \\"#334155\\" }\\n        },\\n        y: {\\n          ticks: { color: \\"#94a3b8\\" },\\n          grid: { color: \\"#334155\\" }\\n        }\\n      }\\n    }\\n  });\\n  if (categoryChart) categoryChart.destroy();\\n  if (categoryData.length > 0) {\\n    categoryChart = new Chart(categoryChartCanvas, {\\n      type: \\"bar\\",\\n      data: {\\n        labels: categoryData.slice(0, 10).map((d) => `${d.icon} ${d.name}`),\\n        datasets: [{\\n          label: \\"Spending\\",\\n          data: categoryData.slice(0, 10).map((d) => d.total),\\n          backgroundColor: \\"#3b82f6\\"\\n        }]\\n      },\\n      options: {\\n        indexAxis: \\"y\\",\\n        responsive: true,\\n        maintainAspectRatio: false,\\n        plugins: {\\n          legend: { display: false }\\n        },\\n        scales: {\\n          x: {\\n            ticks: { color: \\"#94a3b8\\" },\\n            grid: { color: \\"#334155\\" }\\n          },\\n          y: {\\n            ticks: { color: \\"#f8fafc\\" },\\n            grid: { display: false }\\n          }\\n        }\\n      }\\n    });\\n  }\\n}\\n$: totalIncome = monthlyData.reduce((sum, d) => sum + d.income, 0);\\n$: totalExpense = monthlyData.reduce((sum, d) => sum + d.expense, 0);\\n$: totalNet = totalIncome - totalExpense;\\nfunction formatCurrency(amount) {\\n  return amount.toLocaleString(\\"en-US\\", {\\n    style: \\"currency\\",\\n    currency: \\"USD\\"\\n  });\\n}\\n<\/script>\\n\\n<svelte:head>\\n  <title>Reports - Jim\'s Finance Tracker</title>\\n</svelte:head>\\n\\n<div class=\\"page\\">\\n  <h1 class=\\"page-title\\">üìà Reports</h1>\\n  \\n  {#if loading}\\n    <div class=\\"loading\\">Loading reports...‚è≥</div>\\n  {:else if error}\\n    <div class=\\"error\\">{error}</div>\\n  {:else}\\n    <!-- Year Selector -->\\n    <div class=\\"card\\">\\n      <label>Select Year</label>\\n      <select class=\\"input\\" bind:value={selectedYear} on:change={loadData}>\\n        {#each years as year}\\n          <option value={year}>{year}</option>\\n        {/each}\\n      </select>\\n    </div>\\n    \\n    <!-- Annual Summary -->\\n    <div class=\\"metric-grid\\">\\n      <div class=\\"metric-card\\">\\n        <div class=\\"metric-label\\">Total Income</div>\\n        <div class=\\"metric-value income\\">{formatCurrency(totalIncome)}</div>\\n      </div>\\n      \\n      <div class=\\"metric-card\\">\\n        <div class=\\"metric-label\\">Total Expenses</div>\\n        <div class=\\"metric-value expense\\">{formatCurrency(totalExpense)}</div>\\n      </div>\\n      \\n      <div class=\\"metric-card\\">\\n        <div class=\\"metric-label\\">Annual Net</div>\\n        <div class=\\"metric-value\\" class:income={totalNet >= 0} class:expense={totalNet < 0}>\\n          {formatCurrency(totalNet)}\\n        </div>\\n      </div>\\n    </div>\\n    \\n    <!-- Monthly Breakdown Table -->\\n    <div class=\\"card\\">\\n      <h3>Monthly Summary for {selectedYear}</h3>\\n      \\n      <div class=\\"table-container\\">\\n        <table>\\n          <thead>\\n            <tr>\\n              <th>Month</th>\\n              <th>Income</th>\\n              <th>Expenses</th>\\n              <th>Net</th>\\n            </tr>\\n          </thead>\\n          <tbody>\\n            {#each monthlyData as row}\\n              <tr>\\n                <td>{row.month}</td>\\n                <td class=\\"income\\">{formatCurrency(row.income)}</td>\\n                <td class=\\"expense\\">{formatCurrency(row.expense)}</td>\\n                <td class:income={row.net >= 0} class:expense={row.net < 0}>\\n                  {formatCurrency(row.net)}\\n                </td>\\n              </tr>\\n            {/each}\\n          </tbody>\\n        </table>\\n      </div>\\n    </div>\\n    \\n    <!-- Charts -->\\n    <div class=\\"chart-container\\">\\n      <h3>Monthly Trend</h3>\\n      <canvas bind:this={barChartCanvas}></canvas>\\n    </div>\\n    \\n    <div class=\\"chart-container\\">\\n      <h3>Top Spending Categories</h3>\\n      {#if categoryData.length > 0}\\n        <canvas bind:this={categoryChartCanvas}></canvas>\\n      {:else}\\n        <p class=\\"empty-state\\">No expense data for this year</p>\\n      {/if}\\n    </div>\\n  {/if}\\n</div>\\n\\n<style>\\n  .chart-container h3 {\\n    margin-top: 0;\\n    margin-bottom: 1rem;\\n  }\\n  \\n  td.income {\\n    color: #22c55e;\\n  }\\n  \\n  td.expense {\\n    color: #ef4444;\\n  }\\n</style>\\n"],"names":[],"mappings":"AAsNE,8BAAgB,CAAC,gBAAG,CAClB,UAAU,CAAE,CAAC,CACb,aAAa,CAAE,IACjB,CAEA,EAAE,mCAAQ,CACR,KAAK,CAAE,OACT,CAEA,EAAE,oCAAS,CACT,KAAK,CAAE,OACT"}'
};
const Page = create_ssr_component(($$result, $$props, $$bindings, slots) => {
  let monthlyData = [];
  Array.from({ length: 5 }, (_, i) => /* @__PURE__ */ (/* @__PURE__ */ new Date()).getFullYear() - i);
  $$result.css.add(css);
  monthlyData.reduce((sum, d) => sum + d.income, 0);
  monthlyData.reduce((sum, d) => sum + d.expense, 0);
  return `${$$result.head += `<!-- HEAD_svelte-5jgvn5_START -->${$$result.title = `<title>Reports - Jim&#39;s Finance Tracker</title>`, ""}<!-- HEAD_svelte-5jgvn5_END -->`, ""} <div class="page"><h1 class="page-title" data-svelte-h="svelte-1xb71hn">üìà Reports</h1> ${`<div class="loading" data-svelte-h="svelte-16180az">Loading reports...‚è≥</div>`} </div>`;
});
export {
  Page as default
};
