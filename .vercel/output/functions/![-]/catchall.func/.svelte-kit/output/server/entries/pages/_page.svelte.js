import { c as create_ssr_component, f as escape } from "../../chunks/ssr.js";
import "@sveltejs/kit/internal";
import "../../chunks/exports.js";
import "../../chunks/utils.js";
import "@sveltejs/kit/internal/server";
import "../../chunks/state.svelte.js";
import "chart.js/auto";
import "../../chunks/supabase.js";
const css = {
  code: ".bill-item.svelte-8bqry{display:flex;justify-content:space-between;align-items:center;padding:0.875rem 0;border-bottom:1px solid var(--color-border-subtle)}.bill-item.svelte-8bqry:last-child{border-bottom:none}.bill-item-info.svelte-8bqry{display:flex;align-items:center;gap:0.75rem}.bill-item-icon.svelte-8bqry{font-size:1.125rem}.bill-item-name.svelte-8bqry{font-weight:500;color:var(--color-text)}.bill-item-details.svelte-8bqry{display:flex;flex-direction:column;align-items:flex-end;gap:0.125rem}.bill-item-amount.svelte-8bqry{font-family:var(--font-display);font-weight:700;color:var(--color-expense);font-size:0.9375rem}.bill-item-due.svelte-8bqry{font-size:0.75rem;color:var(--color-text-muted)}.welcome-icon.svelte-8bqry{font-size:3rem;margin-bottom:0.75rem}",
  map: `{"version":3,"file":"+page.svelte","sources":["+page.svelte"],"sourcesContent":["<script lang=\\"ts\\">import { onMount, tick } from \\"svelte\\";\\nimport { goto } from \\"$app/navigation\\";\\nimport Chart from \\"chart.js/auto\\";\\nimport {\\n  getMonthlySummary,\\n  getCategoryBreakdown,\\n  getTransactions,\\n  getRecurringBills,\\n  addTransaction,\\n  getCategories\\n} from \\"$lib/api\\";\\nlet loading = true;\\nlet error = \\"\\";\\nlet income = 0;\\nlet expense = 0;\\nlet balance = 0;\\nlet hasTransactions = false;\\nlet upcomingBills = [];\\nlet quickAmount = \\"\\";\\nlet quickType = \\"expense\\";\\nlet quickCategory = null;\\nlet quickNote = \\"\\";\\nlet categories = [];\\nlet filteredCategories = [];\\nlet pieChartCanvas;\\nlet barChartCanvas;\\nlet pieChart = null;\\nlet barChart = null;\\nlet chartsInitialized = false;\\nconst today = /* @__PURE__ */ new Date();\\nconst currentYear = today.getFullYear();\\nconst currentMonth = today.getMonth() + 1;\\n$: filteredCategories = categories.filter(\\n  (c) => quickType === \\"income\\" ? c.is_income === 1 : c.is_income === 0\\n);\\n$: if (filteredCategories.length > 0 && !quickCategory) {\\n  quickCategory = filteredCategories[0].id;\\n}\\nonMount(async () => {\\n  try {\\n    categories = await getCategories();\\n    await loadDashboard();\\n  } catch (e) {\\n    error = e.message;\\n  } finally {\\n    loading = false;\\n  }\\n});\\nasync function loadDashboard() {\\n  const summary = await getMonthlySummary(currentYear, currentMonth);\\n  income = summary.total_income;\\n  expense = summary.total_expense;\\n  balance = income - expense;\\n  const transactions = await getTransactions(1);\\n  hasTransactions = transactions.length > 0;\\n  const bills = await getRecurringBills();\\n  const currentDay = today.getDate();\\n  upcomingBills = bills.filter((b) => b.due_day >= currentDay && b.is_active === 1).slice(0, 3);\\n  await tick();\\n  await loadCharts();\\n}\\nasync function loadCharts() {\\n  if (!pieChartCanvas || !barChartCanvas) {\\n    console.log(\\"Canvas elements not ready, retrying...\\");\\n    setTimeout(loadCharts, 100);\\n    return;\\n  }\\n  if (pieChart) {\\n    pieChart.destroy();\\n    pieChart = null;\\n  }\\n  if (barChart) {\\n    barChart.destroy();\\n    barChart = null;\\n  }\\n  const breakdown = await getCategoryBreakdown(\\"expense\\", currentYear, currentMonth);\\n  if (breakdown.length > 0) {\\n    const pieCtx = pieChartCanvas.getContext(\\"2d\\");\\n    if (pieCtx) {\\n      pieChart = new Chart(pieCtx, {\\n        type: \\"doughnut\\",\\n        data: {\\n          labels: breakdown.map((b) => \`\${b.icon} \${b.name}\`),\\n          datasets: [{\\n            data: breakdown.map((b) => b.total),\\n            backgroundColor: [\\n              \\"#3b82f6\\",\\n              \\"#60a5fa\\",\\n              \\"#93c5fd\\",\\n              \\"#1d4ed8\\",\\n              \\"#1e40af\\",\\n              \\"#10b981\\",\\n              \\"#34d399\\",\\n              \\"#f59e0b\\",\\n              \\"#f43f5e\\",\\n              \\"#8b5cf6\\"\\n            ],\\n            borderWidth: 0,\\n            hoverOffset: 8\\n          }]\\n        },\\n        options: {\\n          responsive: true,\\n          maintainAspectRatio: false,\\n          cutout: \\"65%\\",\\n          plugins: {\\n            legend: {\\n              position: \\"bottom\\",\\n              labels: {\\n                color: \\"#94a3b8\\",\\n                font: { size: 11, family: \\"Inter\\" },\\n                padding: 16,\\n                usePointStyle: true,\\n                pointStyle: \\"circle\\"\\n              }\\n            },\\n            tooltip: {\\n              backgroundColor: \\"#1e293b\\",\\n              titleColor: \\"#f8fafc\\",\\n              bodyColor: \\"#94a3b8\\",\\n              borderColor: \\"#334155\\",\\n              borderWidth: 1,\\n              padding: 12,\\n              callbacks: {\\n                label: (context) => {\\n                  const value = context.parsed;\\n                  const total = context.dataset.data.reduce((a, b) => a + b, 0);\\n                  const percentage = (value / total * 100).toFixed(1);\\n                  return \` $\${value.toLocaleString()} (\${percentage}%)\`;\\n                }\\n              }\\n            }\\n          }\\n        }\\n      });\\n    }\\n  }\\n  const monthsData = [];\\n  for (let i = 5; i >= 0; i--) {\\n    const d = new Date(today.getFullYear(), today.getMonth() - i, 1);\\n    const s = await getMonthlySummary(d.getFullYear(), d.getMonth() + 1);\\n    monthsData.push({\\n      month: d.toLocaleDateString(\\"en-US\\", { month: \\"short\\" }),\\n      income: s.total_income,\\n      expense: s.total_expense\\n    });\\n  }\\n  const barCtx = barChartCanvas.getContext(\\"2d\\");\\n  if (barCtx) {\\n    const incomeGradient = barCtx.createLinearGradient(0, 0, 0, 200);\\n    incomeGradient.addColorStop(0, \\"#10b981\\");\\n    incomeGradient.addColorStop(1, \\"#059669\\");\\n    const expenseGradient = barCtx.createLinearGradient(0, 0, 0, 200);\\n    expenseGradient.addColorStop(0, \\"#f43f5e\\");\\n    expenseGradient.addColorStop(1, \\"#e11d48\\");\\n    barChart = new Chart(barCtx, {\\n      type: \\"bar\\",\\n      data: {\\n        labels: monthsData.map((m) => m.month),\\n        datasets: [\\n          {\\n            label: \\"Income\\",\\n            data: monthsData.map((m) => m.income),\\n            backgroundColor: incomeGradient,\\n            borderRadius: 4,\\n            borderSkipped: false\\n          },\\n          {\\n            label: \\"Expenses\\",\\n            data: monthsData.map((m) => m.expense),\\n            backgroundColor: expenseGradient,\\n            borderRadius: 4,\\n            borderSkipped: false\\n          }\\n        ]\\n      },\\n      options: {\\n        responsive: true,\\n        maintainAspectRatio: false,\\n        plugins: {\\n          legend: {\\n            position: \\"top\\",\\n            align: \\"end\\",\\n            labels: {\\n              color: \\"#94a3b8\\",\\n              font: { size: 11, family: \\"Inter\\" },\\n              usePointStyle: true,\\n              pointStyle: \\"circle\\",\\n              padding: 16\\n            }\\n          },\\n          tooltip: {\\n            backgroundColor: \\"#1e293b\\",\\n            titleColor: \\"#f8fafc\\",\\n            bodyColor: \\"#94a3b8\\",\\n            borderColor: \\"#334155\\",\\n            borderWidth: 1,\\n            padding: 12,\\n            callbacks: {\\n              label: (context) => \` \${context.dataset.label}: $\${context.parsed.y.toLocaleString()}\`\\n            }\\n          }\\n        },\\n        scales: {\\n          x: {\\n            ticks: {\\n              color: \\"#64748b\\",\\n              font: { size: 11, family: \\"Inter\\" }\\n            },\\n            grid: { display: false }\\n          },\\n          y: {\\n            ticks: {\\n              color: \\"#64748b\\",\\n              font: { size: 11, family: \\"Inter\\" },\\n              callback: (value) => \`$\${(value / 1e3).toFixed(0)}k\`\\n            },\\n            grid: {\\n              color: \\"#1f2937\\",\\n              drawBorder: false\\n            }\\n          }\\n        }\\n      }\\n    });\\n  }\\n  chartsInitialized = true;\\n}\\nasync function handleQuickAdd() {\\n  if (!quickAmount || !quickCategory) return;\\n  try {\\n    await addTransaction(\\n      today.toISOString().split(\\"T\\")[0],\\n      parseFloat(quickAmount),\\n      quickCategory,\\n      quickType,\\n      quickNote\\n    );\\n    quickAmount = \\"\\";\\n    quickNote = \\"\\";\\n    await loadDashboard();\\n  } catch (e) {\\n    error = e.message;\\n  }\\n}\\nfunction formatCurrency(amount) {\\n  return amount.toLocaleString(\\"en-US\\", {\\n    minimumFractionDigits: 0,\\n    maximumFractionDigits: 0\\n  });\\n}\\n<\/script>\\n\\n<svelte:head>\\n  <title>Dashboard - Jim's Finance</title>\\n</svelte:head>\\n\\n<div class=\\"page\\">\\n  <header class=\\"page-header\\">\\n    <h1 class=\\"page-title\\">Dashboard</h1>\\n    <p class=\\"page-subtitle\\">{today.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' })}</p>\\n  </header>\\n  \\n  {#if loading}\\n    <div class=\\"loading\\">Loading your finances...</div>\\n  {:else if error}\\n    <div class=\\"error\\">{error}</div>\\n  {:else}\\n    <!-- Metrics -->\\n    <div class=\\"metric-grid animate-fade-in\\">\\n      <div class=\\"metric-card\\">\\n        <div class=\\"metric-label\\">Income</div>\\n        <div class=\\"metric-value income\\">\${formatCurrency(income)}</div>\\n      </div>\\n      \\n      <div class=\\"metric-card\\">\\n        <div class=\\"metric-label\\">Expenses</div>\\n        <div class=\\"metric-value expense\\">\${formatCurrency(expense)}</div>\\n      </div>\\n      \\n      <div class=\\"metric-card\\">\\n        <div class=\\"metric-label\\">Balance</div>\\n        <div class=\\"metric-value\\" class:income={balance >= 0} class:expense={balance < 0}>\\n          \${formatCurrency(balance)}\\n        </div>\\n      </div>\\n    </div>\\n    \\n    <!-- Quick Add -->\\n    <div class=\\"card animate-fade-in stagger-1\\">\\n      <div class=\\"card-header\\">\\n        <h3 class=\\"card-title\\">âš¡ Quick Add</h3>\\n      </div>\\n      \\n      <div class=\\"quick-add-form\\">\\n        <div class=\\"type-selector\\">\\n          <button\\n            type=\\"button\\"\\n            class=\\"type-btn\\"\\n            class:active={quickType === 'expense'}\\n            class:expense-type={quickType === 'expense'}\\n            on:click={() => quickType = 'expense'}\\n          >\\n            ðŸ’¸ Expense\\n          </button>\\n          <button\\n            type=\\"button\\"\\n            class=\\"type-btn\\"\\n            class:active={quickType === 'income'}\\n            class:income-type={quickType === 'income'}\\n            on:click={() => quickType = 'income'}\\n          >\\n            ðŸ’µ Income\\n          </button>\\n        </div>\\n        \\n        <div class=\\"quick-add-row\\">\\n          <div class=\\"form-group\\" style=\\"margin-bottom: 0;\\">\\n            <input\\n              type=\\"number\\"\\n              class=\\"input\\"\\n              bind:value={quickAmount}\\n              placeholder=\\"0.00\\"\\n              step=\\"0.01\\"\\n              min=\\"0\\"\\n            />\\n          </div>\\n          <div class=\\"form-group\\" style=\\"margin-bottom: 0;\\">\\n            <select class=\\"input\\" bind:value={quickCategory}>\\n              {#each filteredCategories as cat}\\n                <option value={cat.id}>{cat.icon} {cat.name}</option>\\n              {/each}\\n            </select>\\n          </div>\\n        </div>\\n        \\n        <input\\n          type=\\"text\\"\\n          class=\\"input\\"\\n          bind:value={quickNote}\\n          placeholder=\\"Add a note (optional)\\"\\n        />\\n        \\n        <button class=\\"btn btn-success\\" on:click={handleQuickAdd} disabled={!quickAmount}>\\n          âž• Add Transaction\\n        </button>\\n      </div>\\n    </div>\\n    \\n    {#if !hasTransactions}\\n      <div class=\\"card welcome-card animate-fade-in stagger-2\\">\\n        <div class=\\"welcome-icon\\">ðŸŽ‰</div>\\n        <h2>Welcome to Jim's Finance!</h2>\\n        <p>Track your money with ease. Here's how to get started:</p>\\n        <ol>\\n          <li>Use <strong>Quick Add</strong> above for your first transaction</li>\\n          <li>Set up recurring bills in <strong>Bills</strong></li>\\n          <li>Import bank data via <strong>Import</strong></li>\\n        </ol>\\n        <p class=\\"highlight\\">Add your first transaction to see your charts!</p>\\n      </div>\\n    {/if}\\n    \\n    <!-- Charts -->\\n    <div class=\\"card chart-container animate-fade-in stagger-3\\">\\n      <h3 class=\\"card-title\\">\\n        <span>ðŸ’³</span>\\n        Spending by Category\\n      </h3>\\n      <div class=\\"chart-wrapper\\">\\n        <canvas bind:this={pieChartCanvas}></canvas>\\n      </div>\\n    </div>\\n    \\n    <div class=\\"card chart-container animate-fade-in stagger-4\\">\\n      <h3 class=\\"card-title\\">\\n        <span>ðŸ“ˆ</span>\\n        Income vs Expenses\\n      </h3>\\n      <div class=\\"chart-wrapper chart-wrapper-lg\\">\\n        <canvas bind:this={barChartCanvas}></canvas>\\n      </div>\\n    </div>\\n    \\n    <!-- Upcoming Bills -->\\n    {#if upcomingBills.length > 0}\\n      <div class=\\"card animate-fade-in stagger-5\\">\\n        <div class=\\"card-header\\">\\n          <h3 class=\\"card-title\\">ðŸ“… Upcoming Bills</h3>\\n        </div>\\n        \\n        {#each upcomingBills as bill}\\n          <div class=\\"bill-item\\">\\n            <div class=\\"bill-item-info\\">\\n              <span class=\\"bill-item-icon\\">ðŸ””</span>\\n              <span class=\\"bill-item-name\\">{bill.name}</span>\\n            </div>\\n            <div class=\\"bill-item-details\\">\\n              <span class=\\"bill-item-amount\\">-\${bill.amount.toLocaleString('en-US', { minimumFractionDigits: 2 })}</span>\\n              <span class=\\"bill-item-due\\">Due {bill.due_day}{['st','nd','rd'][((bill.due_day+90)%100-10)%10-1]||'th'}</span>\\n            </div>\\n          </div>\\n        {/each}\\n      </div>\\n    {/if}\\n  {/if}\\n</div>\\n\\n<style>\\n  .bill-item {\\n    display: flex;\\n    justify-content: space-between;\\n    align-items: center;\\n    padding: 0.875rem 0;\\n    border-bottom: 1px solid var(--color-border-subtle);\\n  }\\n  \\n  .bill-item:last-child {\\n    border-bottom: none;\\n  }\\n  \\n  .bill-item-info {\\n    display: flex;\\n    align-items: center;\\n    gap: 0.75rem;\\n  }\\n  \\n  .bill-item-icon {\\n    font-size: 1.125rem;\\n  }\\n  \\n  .bill-item-name {\\n    font-weight: 500;\\n    color: var(--color-text);\\n  }\\n  \\n  .bill-item-details {\\n    display: flex;\\n    flex-direction: column;\\n    align-items: flex-end;\\n    gap: 0.125rem;\\n  }\\n  \\n  .bill-item-amount {\\n    font-family: var(--font-display);\\n    font-weight: 700;\\n    color: var(--color-expense);\\n    font-size: 0.9375rem;\\n  }\\n  \\n  .bill-item-due {\\n    font-size: 0.75rem;\\n    color: var(--color-text-muted);\\n  }\\n  \\n  .welcome-icon {\\n    font-size: 3rem;\\n    margin-bottom: 0.75rem;\\n  }\\n</style>\\n"],"names":[],"mappings":"AAyZE,uBAAW,CACT,OAAO,CAAE,IAAI,CACb,eAAe,CAAE,aAAa,CAC9B,WAAW,CAAE,MAAM,CACnB,OAAO,CAAE,QAAQ,CAAC,CAAC,CACnB,aAAa,CAAE,GAAG,CAAC,KAAK,CAAC,IAAI,qBAAqB,CACpD,CAEA,uBAAU,WAAY,CACpB,aAAa,CAAE,IACjB,CAEA,4BAAgB,CACd,OAAO,CAAE,IAAI,CACb,WAAW,CAAE,MAAM,CACnB,GAAG,CAAE,OACP,CAEA,4BAAgB,CACd,SAAS,CAAE,QACb,CAEA,4BAAgB,CACd,WAAW,CAAE,GAAG,CAChB,KAAK,CAAE,IAAI,YAAY,CACzB,CAEA,+BAAmB,CACjB,OAAO,CAAE,IAAI,CACb,cAAc,CAAE,MAAM,CACtB,WAAW,CAAE,QAAQ,CACrB,GAAG,CAAE,QACP,CAEA,8BAAkB,CAChB,WAAW,CAAE,IAAI,cAAc,CAAC,CAChC,WAAW,CAAE,GAAG,CAChB,KAAK,CAAE,IAAI,eAAe,CAAC,CAC3B,SAAS,CAAE,SACb,CAEA,2BAAe,CACb,SAAS,CAAE,OAAO,CAClB,KAAK,CAAE,IAAI,kBAAkB,CAC/B,CAEA,0BAAc,CACZ,SAAS,CAAE,IAAI,CACf,aAAa,CAAE,OACjB"}`
};
const Page = create_ssr_component(($$result, $$props, $$bindings, slots) => {
  let quickCategory = null;
  let categories = [];
  let filteredCategories = [];
  const today = /* @__PURE__ */ new Date();
  today.getFullYear();
  today.getMonth() + 1;
  $$result.css.add(css);
  filteredCategories = categories.filter((c) => c.is_income === 0);
  {
    if (filteredCategories.length > 0 && !quickCategory) {
      quickCategory = filteredCategories[0].id;
    }
  }
  return `${$$result.head += `<!-- HEAD_svelte-coalia_START -->${$$result.title = `<title>Dashboard - Jim&#39;s Finance</title>`, ""}<!-- HEAD_svelte-coalia_END -->`, ""} <div class="page"><header class="page-header"><h1 class="page-title" data-svelte-h="svelte-1pxx86r">Dashboard</h1> <p class="page-subtitle">${escape(today.toLocaleDateString("en-US", {
    weekday: "long",
    month: "long",
    day: "numeric"
  }))}</p></header> ${`<div class="loading" data-svelte-h="svelte-1hpd28h">Loading your finances...</div>`} </div>`;
});
export {
  Page as default
};
