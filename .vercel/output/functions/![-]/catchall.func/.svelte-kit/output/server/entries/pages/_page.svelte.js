import { c as create_ssr_component } from "../../chunks/ssr.js";
import "@sveltejs/kit/internal";
import "../../chunks/exports.js";
import "../../chunks/utils.js";
import "@sveltejs/kit/internal/server";
import "../../chunks/state.svelte.js";
import "chart.js/auto";
import "../../chunks/supabase.js";
const css = {
  code: ".quick-add-form.svelte-1v712kd.svelte-1v712kd{display:flex;flex-direction:column;gap:0.75rem}.welcome-card.svelte-1v712kd.svelte-1v712kd{text-align:center;border:2px solid #22c55e}.welcome-card.svelte-1v712kd h2.svelte-1v712kd{color:#22c55e;margin-top:0}.welcome-card.svelte-1v712kd ol.svelte-1v712kd{text-align:left;max-width:400px;margin:1rem auto;color:#94a3b8}.welcome-card.svelte-1v712kd li.svelte-1v712kd{margin-bottom:0.5rem}.highlight.svelte-1v712kd.svelte-1v712kd{color:#22c55e;font-weight:600;margin-top:1rem}.chart-container.svelte-1v712kd h3.svelte-1v712kd{margin-top:0;margin-bottom:1rem;font-size:1rem}.bill-item.svelte-1v712kd.svelte-1v712kd{display:flex;justify-content:space-between;align-items:center;padding:0.75rem 0;border-bottom:1px solid #334155}.bill-item.svelte-1v712kd.svelte-1v712kd:last-child{border-bottom:none}.due-date.svelte-1v712kd.svelte-1v712kd{font-size:0.8rem;color:#94a3b8}",
  map: `{"version":3,"file":"+page.svelte","sources":["+page.svelte"],"sourcesContent":["<script lang=\\"ts\\">import { onMount } from \\"svelte\\";\\nimport { goto } from \\"$app/navigation\\";\\nimport Chart from \\"chart.js/auto\\";\\nimport {\\n  getMonthlySummary,\\n  getCategoryBreakdown,\\n  getTransactions,\\n  getRecurringBills,\\n  addTransaction,\\n  getCategories\\n} from \\"$lib/api\\";\\nlet loading = true;\\nlet error = \\"\\";\\nlet income = 0;\\nlet expense = 0;\\nlet balance = 0;\\nlet hasTransactions = false;\\nlet upcomingBills = [];\\nlet quickAmount = \\"\\";\\nlet quickType = \\"expense\\";\\nlet quickCategory = null;\\nlet quickNote = \\"\\";\\nlet categories = [];\\nlet filteredCategories = [];\\nlet pieChartCanvas;\\nlet barChartCanvas;\\nlet pieChart;\\nlet barChart;\\nconst today = /* @__PURE__ */ new Date();\\nconst currentYear = today.getFullYear();\\nconst currentMonth = today.getMonth() + 1;\\n$: filteredCategories = categories.filter(\\n  (c) => quickType === \\"income\\" ? c.is_income === 1 : c.is_income === 0\\n);\\n$: if (filteredCategories.length > 0 && !quickCategory) {\\n  quickCategory = filteredCategories[0].id;\\n}\\nonMount(async () => {\\n  try {\\n    categories = await getCategories();\\n    await loadDashboard();\\n  } catch (e) {\\n    error = e.message;\\n  } finally {\\n    loading = false;\\n  }\\n});\\nasync function loadDashboard() {\\n  const summary = await getMonthlySummary(currentYear, currentMonth);\\n  income = summary.total_income;\\n  expense = summary.total_expense;\\n  balance = income - expense;\\n  const transactions = await getTransactions(1);\\n  hasTransactions = transactions.length > 0;\\n  const bills = await getRecurringBills();\\n  const currentDay = today.getDate();\\n  upcomingBills = bills.filter((b) => b.due_day >= currentDay && b.is_active === 1);\\n  await loadCharts();\\n}\\nasync function loadCharts() {\\n  const breakdown = await getCategoryBreakdown(\\"expense\\", currentYear, currentMonth);\\n  if (pieChart) pieChart.destroy();\\n  if (breakdown.length > 0) {\\n    pieChart = new Chart(pieChartCanvas, {\\n      type: \\"doughnut\\",\\n      data: {\\n        labels: breakdown.map((b) => \`\${b.icon} \${b.name}\`),\\n        datasets: [{\\n          data: breakdown.map((b) => b.total),\\n          backgroundColor: [\\n            \\"#3b82f6\\",\\n            \\"#ef4444\\",\\n            \\"#22c55e\\",\\n            \\"#f59e0b\\",\\n            \\"#8b5cf6\\",\\n            \\"#ec4899\\",\\n            \\"#14b8a6\\",\\n            \\"#f97316\\",\\n            \\"#6366f1\\",\\n            \\"#84cc16\\"\\n          ]\\n        }]\\n      },\\n      options: {\\n        responsive: true,\\n        maintainAspectRatio: false,\\n        plugins: {\\n          legend: {\\n            position: \\"bottom\\",\\n            labels: { color: \\"#f8fafc\\", font: { size: 11 } }\\n          }\\n        }\\n      }\\n    });\\n  }\\n  const monthsData = [];\\n  for (let i = 5; i >= 0; i--) {\\n    const d = new Date(today.getFullYear(), today.getMonth() - i, 1);\\n    const s = await getMonthlySummary(d.getFullYear(), d.getMonth() + 1);\\n    monthsData.push({\\n      month: d.toLocaleDateString(\\"en-US\\", { month: \\"short\\" }),\\n      income: s.total_income,\\n      expense: s.total_expense\\n    });\\n  }\\n  if (barChart) barChart.destroy();\\n  barChart = new Chart(barChartCanvas, {\\n    type: \\"bar\\",\\n    data: {\\n      labels: monthsData.map((m) => m.month),\\n      datasets: [\\n        {\\n          label: \\"Income\\",\\n          data: monthsData.map((m) => m.income),\\n          backgroundColor: \\"#22c55e\\"\\n        },\\n        {\\n          label: \\"Expenses\\",\\n          data: monthsData.map((m) => m.expense),\\n          backgroundColor: \\"#ef4444\\"\\n        }\\n      ]\\n    },\\n    options: {\\n      responsive: true,\\n      maintainAspectRatio: false,\\n      plugins: {\\n        legend: {\\n          labels: { color: \\"#f8fafc\\" }\\n        }\\n      },\\n      scales: {\\n        x: {\\n          ticks: { color: \\"#94a3b8\\" },\\n          grid: { color: \\"#334155\\" }\\n        },\\n        y: {\\n          ticks: { color: \\"#94a3b8\\" },\\n          grid: { color: \\"#334155\\" }\\n        }\\n      }\\n    }\\n  });\\n}\\nasync function handleQuickAdd() {\\n  if (!quickAmount || !quickCategory) return;\\n  try {\\n    await addTransaction(\\n      today.toISOString().split(\\"T\\")[0],\\n      parseFloat(quickAmount),\\n      quickCategory,\\n      quickType,\\n      quickNote\\n    );\\n    quickAmount = \\"\\";\\n    quickNote = \\"\\";\\n    await loadDashboard();\\n  } catch (e) {\\n    error = e.message;\\n  }\\n}\\n<\/script>\\n\\n<svelte:head>\\n  <title>Dashboard - Jim's Finance Tracker</title>\\n</svelte:head>\\n\\n<div class=\\"page\\">\\n  <h1 class=\\"page-title\\">üìä Dashboard</h1>\\n  \\n  {#if loading}\\n    <div class=\\"loading\\">Loading dashboard...‚è≥</div>\\n  {:else if error}\\n    <div class=\\"error\\">{error}</div>\\n  {:else}\\n    <!-- Quick Add -->\\n    <div class=\\"card\\">\\n      <h3>‚ö° Quick Add</h3>\\n      <div class=\\"quick-add-form\\">\\n        <div class=\\"form-row\\">\\n          <div class=\\"form-group\\">\\n            <input\\n              type=\\"number\\"\\n              class=\\"input\\"\\n              bind:value={quickAmount}\\n              placeholder=\\"Amount\\"\\n              step=\\"0.01\\"\\n              min=\\"0\\"\\n            />\\n          </div>\\n          <div class=\\"form-group\\">\\n            <select class=\\"input\\" bind:value={quickType}>\\n              <option value=\\"expense\\">üí∏ Expense</option>\\n              <option value=\\"income\\">üíµ Income</option>\\n            </select>\\n          </div>\\n        </div>\\n        \\n        <div class=\\"form-row\\">\\n          <div class=\\"form-group\\">\\n            <select class=\\"input\\" bind:value={quickCategory}>\\n              {#each filteredCategories as cat}\\n                <option value={cat.id}>{cat.icon} {cat.name}</option>\\n              {/each}\\n            </select>\\n          </div>\\n          <div class=\\"form-group\\">\\n            <input\\n              type=\\"text\\"\\n              class=\\"input\\"\\n              bind:value={quickNote}\\n              placeholder=\\"Note (optional)\\"\\n            />\\n          </div>\\n        </div>\\n        \\n        <button class=\\"btn btn-success\\" on:click={handleQuickAdd} disabled={!quickAmount}>\\n          ‚ûï Add Transaction\\n        </button>\\n      </div>\\n    </div>\\n    \\n    {#if !hasTransactions}\\n      <div class=\\"card welcome-card\\">\\n        <h2>üéâ Welcome to Jim's Finance Tracker!</h2>\\n        <p>Get started in just a few steps:</p>\\n        <ol>\\n          <li>Use <strong>Quick Add</strong> above to add your first transaction</li>\\n          <li>Set up recurring bills in <strong>Bills</strong></li>\\n          <li>Import your bank transactions via <strong>Import CSV</strong></li>\\n        </ol>\\n        <p class=\\"highlight\\">Add your first transaction above to get started!</p>\\n      </div>\\n    {/if}\\n    \\n    <!-- Metrics -->\\n    <div class=\\"metric-grid\\">\\n      <div class=\\"metric-card\\">\\n        <div class=\\"metric-label\\">üíµ Monthly Income</div>\\n        <div class=\\"metric-value income\\">\${income.toLocaleString('en-US', { minimumFractionDigits: 2 })}</div>\\n      </div>\\n      \\n      <div class=\\"metric-card\\">\\n        <div class=\\"metric-label\\">üí∏ Monthly Expenses</div>\\n        <div class=\\"metric-value expense\\">\${expense.toLocaleString('en-US', { minimumFractionDigits: 2 })}</div>\\n      </div>\\n      \\n      <div class=\\"metric-card\\">\\n        <div class=\\"metric-label\\">üìà Balance</div>\\n        <div class=\\"metric-value\\" class:income={balance >= 0} class:expense={balance < 0}>\\n          \${balance.toLocaleString('en-US', { minimumFractionDigits: 2 })}\\n        </div>\\n      </div>\\n    </div>\\n    \\n    <!-- Charts -->\\n    <div class=\\"chart-container\\">\\n      <h3>üí≥ Spending by Category</h3>\\n      <canvas bind:this={pieChartCanvas}></canvas>\\n    </div>\\n    \\n    <div class=\\"chart-container\\">\\n      <h3>üìà Income vs Expenses (6 Months)</h3>\\n      <canvas bind:this={barChartCanvas}></canvas>\\n    </div>\\n    \\n    <!-- Upcoming Bills -->\\n    {#if upcomingBills.length > 0}\\n      <div class=\\"card\\">\\n        <h3>üìÖ Upcoming Bills This Month</h3>\\n        \\n        {#each upcomingBills as bill}\\n          <div class=\\"bill-item\\">\\n            <span>üîî {bill.name}</span>\\n            <span class=\\"expense\\">-\${bill.amount.toLocaleString('en-US', { minimumFractionDigits: 2 })}</span>\\n            <span class=\\"due-date\\">Due {bill.due_day}{['st','nd','rd'][((bill.due_day+90)%100-10)%10-1]||'th'}</span>\\n          </div>\\n        {/each}\\n      </div>\\n    {/if}\\n  {/if}\\n</div>\\n\\n<style>\\n  .quick-add-form {\\n    display: flex;\\n    flex-direction: column;\\n    gap: 0.75rem;\\n  }\\n  \\n  .welcome-card {\\n    text-align: center;\\n    border: 2px solid #22c55e;\\n  }\\n  \\n  .welcome-card h2 {\\n    color: #22c55e;\\n    margin-top: 0;\\n  }\\n  \\n  .welcome-card ol {\\n    text-align: left;\\n    max-width: 400px;\\n    margin: 1rem auto;\\n    color: #94a3b8;\\n  }\\n  \\n  .welcome-card li {\\n    margin-bottom: 0.5rem;\\n  }\\n  \\n  .highlight {\\n    color: #22c55e;\\n    font-weight: 600;\\n    margin-top: 1rem;\\n  }\\n  \\n  .chart-container h3 {\\n    margin-top: 0;\\n    margin-bottom: 1rem;\\n    font-size: 1rem;\\n  }\\n  \\n  .bill-item {\\n    display: flex;\\n    justify-content: space-between;\\n    align-items: center;\\n    padding: 0.75rem 0;\\n    border-bottom: 1px solid #334155;\\n  }\\n  \\n  .bill-item:last-child {\\n    border-bottom: none;\\n  }\\n  \\n  .due-date {\\n    font-size: 0.8rem;\\n    color: #94a3b8;\\n  }\\n</style>\\n"],"names":[],"mappings":"AA4RE,6CAAgB,CACd,OAAO,CAAE,IAAI,CACb,cAAc,CAAE,MAAM,CACtB,GAAG,CAAE,OACP,CAEA,2CAAc,CACZ,UAAU,CAAE,MAAM,CAClB,MAAM,CAAE,GAAG,CAAC,KAAK,CAAC,OACpB,CAEA,4BAAa,CAAC,iBAAG,CACf,KAAK,CAAE,OAAO,CACd,UAAU,CAAE,CACd,CAEA,4BAAa,CAAC,iBAAG,CACf,UAAU,CAAE,IAAI,CAChB,SAAS,CAAE,KAAK,CAChB,MAAM,CAAE,IAAI,CAAC,IAAI,CACjB,KAAK,CAAE,OACT,CAEA,4BAAa,CAAC,iBAAG,CACf,aAAa,CAAE,MACjB,CAEA,wCAAW,CACT,KAAK,CAAE,OAAO,CACd,WAAW,CAAE,GAAG,CAChB,UAAU,CAAE,IACd,CAEA,+BAAgB,CAAC,iBAAG,CAClB,UAAU,CAAE,CAAC,CACb,aAAa,CAAE,IAAI,CACnB,SAAS,CAAE,IACb,CAEA,wCAAW,CACT,OAAO,CAAE,IAAI,CACb,eAAe,CAAE,aAAa,CAC9B,WAAW,CAAE,MAAM,CACnB,OAAO,CAAE,OAAO,CAAC,CAAC,CAClB,aAAa,CAAE,GAAG,CAAC,KAAK,CAAC,OAC3B,CAEA,wCAAU,WAAY,CACpB,aAAa,CAAE,IACjB,CAEA,uCAAU,CACR,SAAS,CAAE,MAAM,CACjB,KAAK,CAAE,OACT"}`
};
const Page = create_ssr_component(($$result, $$props, $$bindings, slots) => {
  let quickCategory = null;
  let categories = [];
  let filteredCategories = [];
  const today = /* @__PURE__ */ new Date();
  today.getFullYear();
  today.getMonth() + 1;
  $$result.css.add(css);
  filteredCategories = categories.filter((c) => c.is_income === 0);
  {
    if (filteredCategories.length > 0 && !quickCategory) {
      quickCategory = filteredCategories[0].id;
    }
  }
  return `${$$result.head += `<!-- HEAD_svelte-14i2b12_START -->${$$result.title = `<title>Dashboard - Jim&#39;s Finance Tracker</title>`, ""}<!-- HEAD_svelte-14i2b12_END -->`, ""} <div class="page"><h1 class="page-title" data-svelte-h="svelte-15v4he8">üìä Dashboard</h1> ${`<div class="loading" data-svelte-h="svelte-hrlzf0">Loading dashboard...‚è≥</div>`} </div>`;
});
export {
  Page as default
};
